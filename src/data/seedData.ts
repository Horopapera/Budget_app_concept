import type { Rule, InboxItem, ActualRecord, Finding } from './types';

const today = new Date();
const formatDate = (date: Date): string => date.toISOString().split('T')[0];

const daysAgo = (days: number): string => {
  const d = new Date(today);
  d.setDate(d.getDate() - days);
  return formatDate(d);
};

const daysFromNow = (days: number): string => {
  const d = new Date(today);
  d.setDate(d.getDate() + days);
  return formatDate(d);
};

export const rules: Rule[] = [
  {
    id: 'rule-1',
    name: 'Rent',
    description: 'Monthly apartment rent payment',
    amount: 1800,
    frequency: 'monthly',
    needType: 'essential',
    costType: 'fixed',
    status: 'active',
    nextDueDate: daysFromNow(5),
    createdAt: daysAgo(90),
  },
  {
    id: 'rule-2',
    name: 'Electricity',
    description: 'Monthly electricity bill',
    amount: 120,
    frequency: 'monthly',
    needType: 'essential',
    costType: 'fixed',
    status: 'active',
    nextDueDate: formatDate(today),
    createdAt: daysAgo(90),
  },
  {
    id: 'rule-3',
    name: 'Water',
    description: 'Monthly water utility bill',
    amount: 45,
    frequency: 'monthly',
    needType: 'essential',
    costType: 'fixed',
    status: 'active',
    nextDueDate: daysFromNow(12),
    createdAt: daysAgo(90),
  },
  {
    id: 'rule-4',
    name: 'Internet',
    description: 'Home internet service',
    amount: 79,
    frequency: 'monthly',
    needType: 'essential',
    costType: 'fixed',
    status: 'active',
    nextDueDate: daysFromNow(8),
    createdAt: daysAgo(60),
  },
  {
    id: 'rule-5',
    name: 'Phone',
    description: 'Mobile phone plan',
    amount: 55,
    frequency: 'monthly',
    needType: 'essential',
    costType: 'fixed',
    status: 'active',
    nextDueDate: daysFromNow(15),
    createdAt: daysAgo(60),
  },
  {
    id: 'rule-6',
    name: 'Car Insurance',
    description: 'Monthly car insurance premium',
    amount: 140,
    frequency: 'monthly',
    needType: 'essential',
    costType: 'fixed',
    status: 'active',
    nextDueDate: daysFromNow(20),
    createdAt: daysAgo(45),
  },
  {
    id: 'rule-7',
    name: 'Groceries',
    description: 'Weekly grocery shopping',
    amount: 200,
    frequency: 'weekly',
    needType: 'essential',
    costType: 'variable',
    status: 'active',
    nextDueDate: formatDate(today),
    createdAt: daysAgo(90),
  },
  {
    id: 'rule-8',
    name: 'Fuel',
    description: 'Weekly fuel for commuting',
    amount: 60,
    frequency: 'weekly',
    needType: 'essential',
    costType: 'variable',
    status: 'active',
    nextDueDate: daysAgo(2),
    createdAt: daysAgo(90),
  },
  {
    id: 'rule-9',
    name: 'Netflix',
    description: 'Streaming subscription',
    amount: 15.99,
    frequency: 'monthly',
    needType: 'nonEssential',
    costType: 'fixed',
    status: 'active',
    nextDueDate: formatDate(today),
    createdAt: daysAgo(60),
  },
  {
    id: 'rule-10',
    name: 'Gym Membership',
    description: 'Monthly gym access',
    amount: 49,
    frequency: 'monthly',
    needType: 'nonEssential',
    costType: 'fixed',
    status: 'active',
    nextDueDate: daysFromNow(7),
    createdAt: daysAgo(30),
  },
  {
    id: 'rule-11',
    name: 'Dining Out',
    description: 'Weekly restaurant budget',
    amount: 100,
    frequency: 'weekly',
    needType: 'nonEssential',
    costType: 'variable',
    status: 'active',
    nextDueDate: daysAgo(1),
    createdAt: daysAgo(60),
  },
  {
    id: 'rule-12',
    name: 'Entertainment',
    description: 'Movies, games, events',
    amount: 75,
    frequency: 'fortnightly',
    needType: 'nonEssential',
    costType: 'variable',
    status: 'paused',
    nextDueDate: daysFromNow(3),
    createdAt: daysAgo(45),
  },
];

export const inboxItems: InboxItem[] = [
  {
    id: 'inbox-1',
    ruleId: 'rule-7',
    dueDate: daysAgo(3),
    originalDueDate: daysAgo(3),
    expectedAmount: 200,
    state: 'pending',
    notes: null,
  },
  {
    id: 'inbox-2',
    ruleId: 'rule-8',
    dueDate: daysAgo(2),
    originalDueDate: daysAgo(2),
    expectedAmount: 60,
    state: 'pending',
    notes: null,
  },
  {
    id: 'inbox-3',
    ruleId: 'rule-11',
    dueDate: daysAgo(1),
    originalDueDate: daysAgo(1),
    expectedAmount: 100,
    state: 'pending',
    notes: null,
  },
  {
    id: 'inbox-4',
    ruleId: 'rule-2',
    dueDate: formatDate(today),
    originalDueDate: formatDate(today),
    expectedAmount: 180,
    state: 'pending',
    notes: 'Higher than usual - summer AC usage',
  },
  {
    id: 'inbox-5',
    ruleId: 'rule-9',
    dueDate: formatDate(today),
    originalDueDate: formatDate(today),
    expectedAmount: 15.99,
    state: 'pending',
    notes: null,
  },
  {
    id: 'inbox-6',
    ruleId: 'rule-7',
    dueDate: formatDate(today),
    originalDueDate: formatDate(today),
    expectedAmount: 215,
    state: 'pending',
    notes: 'Stocking up for the week',
  },
  {
    id: 'inbox-7',
    ruleId: 'rule-1',
    dueDate: daysFromNow(5),
    originalDueDate: daysFromNow(5),
    expectedAmount: 1800,
    state: 'pending',
    notes: null,
  },
  {
    id: 'inbox-8',
    ruleId: 'rule-10',
    dueDate: daysFromNow(7),
    originalDueDate: daysFromNow(7),
    expectedAmount: 49,
    state: 'pending',
    notes: null,
  },
  {
    id: 'inbox-9',
    ruleId: 'rule-12',
    dueDate: daysFromNow(3),
    originalDueDate: daysFromNow(3),
    expectedAmount: 75,
    state: 'pending',
    notes: 'Concert tickets planned',
  },
  {
    id: 'inbox-10',
    ruleId: 'rule-4',
    dueDate: daysFromNow(8),
    originalDueDate: daysFromNow(8),
    expectedAmount: 79,
    state: 'pending',
    notes: null,
  },
];

const generateGroceryRecords = (): ActualRecord[] => {
  const records: ActualRecord[] = [];
  const baseAmount = 185;
  for (let week = 12; week >= 1; week--) {
    const increase = (12 - week) * 2.5;
    records.push({
      id: `actual-grocery-${week}`,
      ruleId: 'rule-7',
      inboxItemId: null,
      description: 'Groceries',
      amount: Math.round((baseAmount + increase) * 100) / 100,
      needType: 'essential',
      costType: 'variable',
      source: 'recurring-confirmed',
      recordedAt: daysAgo(week * 7),
    });
  }
  return records;
};

const generateFuelRecords = (): ActualRecord[] => {
  const records: ActualRecord[] = [];
  for (let week = 12; week >= 1; week--) {
    const variance = Math.random() * 10 - 5;
    records.push({
      id: `actual-fuel-${week}`,
      ruleId: 'rule-8',
      inboxItemId: null,
      description: 'Fuel',
      amount: Math.round((60 + variance) * 100) / 100,
      needType: 'essential',
      costType: 'variable',
      source: 'recurring-confirmed',
      recordedAt: daysAgo(week * 7),
    });
  }
  return records;
};

export const actualRecords: ActualRecord[] = [
  ...generateGroceryRecords(),
  ...generateFuelRecords(),
  {
    id: 'actual-rent-1',
    ruleId: 'rule-1',
    inboxItemId: null,
    description: 'Rent - March',
    amount: 1800,
    needType: 'essential',
    costType: 'fixed',
    source: 'recurring-confirmed',
    recordedAt: daysAgo(60),
  },
  {
    id: 'actual-rent-2',
    ruleId: 'rule-1',
    inboxItemId: null,
    description: 'Rent - April',
    amount: 1800,
    needType: 'essential',
    costType: 'fixed',
    source: 'recurring-confirmed',
    recordedAt: daysAgo(30),
  },
  {
    id: 'actual-rent-3',
    ruleId: 'rule-1',
    inboxItemId: null,
    description: 'Rent - May',
    amount: 1800,
    needType: 'essential',
    costType: 'fixed',
    source: 'recurring-confirmed',
    recordedAt: daysAgo(5),
  },
  {
    id: 'actual-electricity-1',
    ruleId: 'rule-2',
    inboxItemId: null,
    description: 'Electricity - March',
    amount: 95,
    needType: 'essential',
    costType: 'fixed',
    source: 'recurring-confirmed',
    recordedAt: daysAgo(60),
  },
  {
    id: 'actual-electricity-2',
    ruleId: 'rule-2',
    inboxItemId: null,
    description: 'Electricity - April',
    amount: 110,
    needType: 'essential',
    costType: 'fixed',
    source: 'recurring-confirmed',
    recordedAt: daysAgo(30),
  },
  {
    id: 'actual-electricity-3',
    ruleId: 'rule-2',
    inboxItemId: null,
    description: 'Electricity - May (spike)',
    amount: 165,
    needType: 'essential',
    costType: 'fixed',
    source: 'recurring-confirmed',
    recordedAt: daysAgo(5),
  },
  {
    id: 'actual-netflix-1',
    ruleId: 'rule-9',
    inboxItemId: null,
    description: 'Netflix - March',
    amount: 15.99,
    needType: 'nonEssential',
    costType: 'fixed',
    source: 'recurring-confirmed',
    recordedAt: daysAgo(60),
  },
  {
    id: 'actual-netflix-2',
    ruleId: 'rule-9',
    inboxItemId: null,
    description: 'Netflix - April',
    amount: 15.99,
    needType: 'nonEssential',
    costType: 'fixed',
    source: 'recurring-confirmed',
    recordedAt: daysAgo(30),
  },
  {
    id: 'actual-gym-1',
    ruleId: 'rule-10',
    inboxItemId: null,
    description: 'Gym Membership - April',
    amount: 49,
    needType: 'nonEssential',
    costType: 'fixed',
    source: 'recurring-confirmed',
    recordedAt: daysAgo(30),
  },
  {
    id: 'actual-variable-1',
    ruleId: null,
    inboxItemId: null,
    description: 'Coffee shop - work meeting',
    amount: 24.50,
    needType: 'nonEssential',
    costType: 'variable',
    source: 'variable-checkin',
    recordedAt: daysAgo(3),
  },
  {
    id: 'actual-variable-2',
    ruleId: null,
    inboxItemId: null,
    description: 'Pharmacy - cold medicine',
    amount: 18.75,
    needType: 'essential',
    costType: 'variable',
    source: 'variable-checkin',
    recordedAt: daysAgo(8),
  },
  {
    id: 'actual-variable-3',
    ruleId: null,
    inboxItemId: null,
    description: 'Parking - downtown',
    amount: 12.00,
    needType: 'nonEssential',
    costType: 'variable',
    source: 'variable-checkin',
    recordedAt: daysAgo(2),
  },
  {
    id: 'actual-variable-4',
    ruleId: null,
    inboxItemId: null,
    description: 'Birthday gift',
    amount: 45.00,
    needType: 'nonEssential',
    costType: 'variable',
    source: 'variable-checkin',
    recordedAt: daysAgo(12),
  },
];

export const findings: Finding[] = [
  {
    id: 'finding-1',
    type: 'CATEGORY_TREND_UP',
    title: 'Grocery spending trending upward',
    description: 'Your weekly grocery spending has increased by approximately 8% over the past 6 weeks. Starting at $185 per week and now averaging $212. This trend may indicate price increases or changes in shopping habits.',
    severity: 'warning',
    relatedRuleIds: ['rule-7'],
    detectedAt: formatDate(today),
    periodStart: daysAgo(42),
    periodEnd: formatDate(today),
  },
  {
    id: 'finding-2',
    type: 'BILL_INCREASE',
    title: 'Electricity bill increased significantly',
    description: 'Your May electricity bill of $165 is 50% higher than your 3-month average of $110. This spike coincides with seasonal changes - consider reviewing AC usage or checking for unusual consumption.',
    severity: 'attention',
    relatedRuleIds: ['rule-2'],
    detectedAt: daysAgo(5),
    periodStart: daysAgo(90),
    periodEnd: daysAgo(5),
  },
  {
    id: 'finding-3',
    type: 'SPIKE_DETECTED',
    title: 'Unusual dining expenses detected',
    description: 'Last week showed higher than typical dining out expenses. Combined with variable check-ins, your non-essential variable spending was 35% above your usual weekly pattern.',
    severity: 'info',
    relatedRuleIds: ['rule-11'],
    detectedAt: daysAgo(2),
    periodStart: daysAgo(7),
    periodEnd: formatDate(today),
  },
  {
    id: 'finding-4',
    type: 'PERIOD_COMPARISON',
    title: 'Essential spending up this month',
    description: 'Your essential expenses this month are 5% higher than last month. The main contributors are groceries (+8%) and electricity (+50%). Consider reviewing these categories for potential savings.',
    severity: 'info',
    relatedRuleIds: ['rule-7', 'rule-2'],
    detectedAt: formatDate(today),
    periodStart: daysAgo(30),
    periodEnd: formatDate(today),
  },
];
